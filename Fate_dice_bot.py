import random
from telegram import Update
from telegram.ext import Application, CommandHandler, ContextTypes

# ==== ะขะพะปะบะพะฒะฐะฝะธั ====
SUM_INTERPRETATION = {
    2: "โ ะะตะฒะพะทะผะพะถะฝะพ. ะะต ะฒัะตะผั, ะฝะต ัั, ะฝะต ััะดัะฑะฐ.",
    3: "๐ฏ๏ธ ะขะตะฝั ัะฐะฝัะฐ. ะัะตะฝั ะผะฐะปะตะฝัะบะธะน ะฟัะพะฑะปะตัะบ.",
    4: "โ๏ธ ะัั ะทะฐะฒะธัะธั ะพั ะพะฑััะพััะตะปัััะฒ. ะัะถะฝั ััะธะปะธั.",
    5: "๐ ะะตะฟัะตะดัะบะฐะทัะตะผะพััั. ะะตัะตะผะตะฝั ะฒ ะดะฒะธะถะตะฝะธะธ.",
    6: "๐ซ๏ธ ะะพะทะผะพะถะฝะพััั ะตััั, ะฝะพ ัะบัััะฐ. ะขัะตะฑัะตััั ะธะฝััะธัะธั.",
    7: "๐ซ ะะพะปััะธััั, ะฝะพ ะฝะต ัะฐะบ, ะบะฐะบ ัั ะดัะผะฐะตัั.",
    8: "๐ฎ ะััะพะบะฐั ะฒะตััััะฝะพััั ััะฟะตัะฐ. ะะตะนััะฒัะน!",
    9: "๐ ะะฐ, ะตัะปะธ ะดะตะนััะฒะพะฒะฐัั ัะผะฝะพ ะธ ะฒะพะฒัะตะผั.",
    10: "๐ ะฃัะฟะตั ะฟะพััะธ ะณะฐัะฐะฝัะธัะพะฒะฐะฝ. ะะพะฑะตะดะฐ ะฑะปะธะทะบะฐ.",
    11: "๐ ะงัะดะพ ะธะปะธ ะฝะตะพะถะธะดะฐะฝะฝัะน ะฟะพะฒะพัะพั. ะะปะฐะณะพะฟัะธััะฝัะน ะทะฝะฐะบ.",
    12: "โ ะะพะปะพะถะธัะตะปัะฝัะน ะพัะฒะตั. ะกัะดัะฑะฐ ะณะพะฒะพัะธั 'ะดะฐ'.",
}

DICE_COMBINATIONS = {
    (1, 1): "ะฆะธะบะป ะทะฐะฒะตัััะฝ. ะะฐัะฝัััั ะฝะพะฒะพะต.",
    (1, 2): "ะะตัะฒัะน ัะฐะณ. ะัะบััะฒะฐะตััั ะดะฒะตัั.",
    (1, 3): "ะััะปะธ ะพ ะฒะพะทะผะพะถะฝะพะผ ะฑัะดััะตะผ.",
    (1, 4): "ะัะถะฝะพ ะฒัะตะผั. ะะพะดะพะถะดะธ.",
    (1, 5): "ะะพะผะบะฐ ััะฐัะพะณะพ. ะะพะฒะพะต ะฝะฐัะธะฝะฐะตััั.",
    (1, 6): "ะงัะดะพ ะฒะพะทะผะพะถะฝะพ. ะฃะดะฐัะฐ ะฝะฐ ัะฒะพะตะน ััะพัะพะฝะต.",
    (2, 2): "ะขั ะฒะธะดะธัั ัะตะฑั ัะพ ััะพัะพะฝั. ะัะฟััะฐะฝะธะต ะทะตัะบะฐะปะพะผ.",
    (2, 3): "ะะธะฐะปะพะณ ะฒะฝัััะธ ัะตะฑั. ะะฝัััะตะฝะฝะธะน ะบะพะฝัะปะธะบั ะธะปะธ ะณะฐัะผะพะฝะธั.",
    (2, 4): "ะะฐะปะฐะฝั ัะธะป. ะัะถะฝะพ ะฝะฐะนัะธ ัะฐะฒะฝะพะฒะตัะธะต.",
    (2, 5): "ะะตัะตะผะตะฝั ะฝะตะธะทะฑะตะถะฝั. ะัะธะผะธ ะธั.",
    (2, 6): "ะะพะดะดะตัะถะบะฐ ัะฒััะต. ะัะพ-ัะพ ะฟะพะผะพะณะฐะตั ัะตะฑะต.",
    (3, 3): "ะกะพะทะดะฐะฝะธะต. ะงัะพ ัั ะทะฐะดัะผะฐะป โ ะฒะพะฟะปะพัะธััั.",
    (3, 4): "ะกััะพะธัะตะปัััะฒะพ. ะขั ัััะพะธัั ะฝะพะฒัะน ััะฐะฟ.",
    (3, 5): "ะะฐะทัััะตะฝะธะต ะดะปั ัะพััะฐ. ะกัะฐัะพะต ััะพะดะธั.",
    (3, 6): "ะขะฒะพััะตัะบะฐั ะฟะพะฑะตะดะฐ. ะัะบััััะฒะพ ะธะปะธ ะฟัะพะตะบั ะฑัะดัั ะทะฐะผะตัะตะฝั.",
    (4, 4): "ะัะฟััะฐะฝะธะต ัะตัะฟะตะฝะธะตะผ. ะกะธะปะฐ ะฒ ััะพะนะบะพััะธ.",
    (4, 5): "ะะพะฝะตั ะพะดะฝะพะณะพ, ะฝะฐัะฐะปะพ ะดััะณะพะณะพ. ะะตัะตัะพะด.",
    (4, 6): "ะกัะฐะฑะธะปัะฝะฐั ะฟะพะดะดะตัะถะบะฐ. ะฃัะฟะตั ะฑัะดะตั ะดะพะปะณะธะผ.",
    (5, 5): "ะะพะปะฝะพะต ัะฐะทัััะตะฝะธะต ััะฐัะพะณะพ. ะะฑะฝะพะฒะปะตะฝะธะต.",
    (5, 6): "ะะตะทะบะธะน ัะบะฐัะพะบ. ะะฝะตะทะฐะฟะฝัะน ััะฟะตั.",
    (6, 6): "ะัััะฐั ัะดะฐัะฐ. ะัะต ะทะฒัะทะดั ัะพัะปะธัั.",
}

# ==== ะคัะฝะบัะธะธ ====
def throw_dice():
    return random.randint(1, 6), random.randint(1, 6)

def interpret(a, b):
    total = a + b
    is_pair = a == b
    energy = "a > b" if a > b else ("a < b" if a < b else "a = b")

    result = {
        "dice": (a, b),
        "total": total,
        "is_pair": is_pair,
        "energy": energy,
        "sum_interpretation": SUM_INTERPRETATION[total],
        "combination_interpretation": DICE_COMBINATIONS.get((a, b), None),
        "pair_interpretation": DICE_COMBINATIONS.get((a, b), None) if is_pair else None
    }

    return result

# ==== ะะพะผะฐะฝะดะฐ /ask ====
async def ask(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_question = " ".join(context.args) if context.args else "ะะต ะทะฐะดะฐะฝ."

    a, b = throw_dice()
    interpretation = interpret(a, b)

    message = f"๐ฎ **ะะพะฟัะพั:** {user_question}\n\n"
    message += f"๐ฒ **ะัะฟะฐะปะธ ะบะพััะธ:** ({a}, {b}) โ ััะผะผะฐ: {interpretation['total']}\n\n"
    message += f"๐ **ะัะฝะพะฒะฝะพะน ะพัะฒะตั:** {interpretation['sum_interpretation']}\n"

    if interpretation["combination_interpretation"]:
        message += f"\n๐งฉ **ะะพะผะฑะธะฝะฐัะธั ({a},{b}):** {interpretation['combination_interpretation']}"

    if interpretation["pair_interpretation"]:
        message += f"\n\n๐ **ะญัะพ ะฟะฐัะฐ!** {interpretation['pair_interpretation']}"

    energy_meaning = {
        "a > b": "๐ธ ะขั ะฒะตะดััั ัะธัั
